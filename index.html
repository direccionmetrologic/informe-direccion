<!DOCTYPE html>
<html lang="es"><head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0">
<title>Informe de Direcci√≥n ‚Äî Laboratorio de Calibraci√≥n</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,500;9..40,700&family=Playfair+Display:wght@600;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#0b0f19;--bg2:#111827;--bg3:#1a2234;--card:#161e2e;
  --border:#263045;--border2:#334155;
  --txt:#e2e8f0;--txt2:#94a3b8;--txt3:#64748b;
  --accent:#60a5fa;--accent2:#3b82f6;--green:#34d399;--green2:#059669;
  --amber:#fbbf24;--amber2:#d97706;--red:#f87171;--red2:#dc2626;
  --purple:#a78bfa;--purple2:#7c3aed;--orange:#fb923c;--orange2:#ea580c;
  --font:'DM Sans',system-ui,-apple-system,sans-serif;
  --display:'Playfair Display',Georgia,serif;
  --rad:14px;--rad-sm:10px;
}
html{scroll-behavior:smooth;-webkit-text-size-adjust:100%}
body{font-family:var(--font);background:var(--bg);color:var(--txt);line-height:1.6;min-height:100vh;
  background-image:radial-gradient(ellipse 80% 50% at 50% -20%,rgba(59,130,246,.08),transparent),
    radial-gradient(ellipse 60% 40% at 100% 0%,rgba(124,58,237,.05),transparent)}
.container{max-width:1320px;margin:0 auto;padding:0 24px}
@media(max-width:768px){.container{padding:0 14px}}
.header{background:linear-gradient(135deg,#0f172a 0%,#1e293b 50%,#0f172a 100%);border-bottom:1px solid var(--border);padding:40px 0 32px;position:relative;overflow:hidden}
.header::before{content:'';position:absolute;top:-60%;right:-10%;width:500px;height:500px;background:radial-gradient(circle,rgba(96,165,250,.08),transparent 70%);pointer-events:none}
.header-inner{display:flex;justify-content:space-between;align-items:flex-end;flex-wrap:wrap;gap:16px}
.header h1{font-family:var(--display);font-size:clamp(1.6rem,4vw,2.5rem);font-weight:800;letter-spacing:-.02em;color:#fff;line-height:1.15}
.header h1 span{background:linear-gradient(135deg,var(--accent),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.header-meta{text-align:right}
.header-meta .periodo{font-size:1.05rem;font-weight:700;color:var(--accent);background:rgba(96,165,250,.1);padding:6px 16px;border-radius:999px;border:1px solid rgba(96,165,250,.2);display:inline-block}
.header-meta .fecha{font-size:.82rem;color:var(--txt3);margin-top:8px}
.kpi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;margin:28px 0 36px}
.kpi-card{background:var(--card);border:1px solid var(--border);border-radius:var(--rad);padding:20px 18px;position:relative;overflow:hidden;transition:transform .2s}
.kpi-card:hover{transform:translateY(-3px)}
.kpi-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;border-radius:var(--rad) var(--rad) 0 0}
.kpi-card.cal::before{background:linear-gradient(90deg,var(--green),var(--green2))}
.kpi-card.tec::before{background:linear-gradient(90deg,var(--accent),var(--accent2))}
.kpi-card.serv::before{background:linear-gradient(90deg,var(--amber),var(--amber2))}
.kpi-card.nov::before{background:linear-gradient(90deg,var(--orange),var(--orange2))}
.kpi-card.sup::before{background:linear-gradient(90deg,var(--purple),var(--purple2))}
.kpi-label{font-size:.78rem;font-weight:500;color:var(--txt3);text-transform:uppercase;letter-spacing:.06em}
.kpi-value{font-family:var(--display);font-size:2.2rem;font-weight:800;line-height:1.1;margin:6px 0 2px}
.kpi-card.cal .kpi-value{color:var(--green)}.kpi-card.tec .kpi-value{color:var(--accent)}
.kpi-card.serv .kpi-value{color:var(--amber)}.kpi-card.nov .kpi-value{color:var(--orange)}
.kpi-card.sup .kpi-value{color:var(--purple)}
.kpi-sub{font-size:.78rem;color:var(--txt3)}
.section{margin-bottom:36px}
.section-header{display:flex;align-items:center;gap:12px;margin-bottom:18px;padding-bottom:12px;border-bottom:1px solid var(--border)}
.section-icon{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;flex-shrink:0}
.section-icon.green{background:rgba(52,211,153,.12);color:var(--green)}
.section-icon.amber{background:rgba(251,191,36,.12);color:var(--amber)}
.section-icon.orange{background:rgba(251,146,60,.12);color:var(--orange)}
.section-icon.purple{background:rgba(167,139,250,.12);color:var(--purple)}
.section-title{font-family:var(--display);font-size:1.35rem;font-weight:600;color:#fff}
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--rad);padding:24px}
.card-title{font-size:.85rem;font-weight:700;color:var(--txt2);text-transform:uppercase;letter-spacing:.04em;margin-bottom:16px}
.row{display:grid;gap:18px}.row.c2{grid-template-columns:repeat(2,1fr)}.row.c3{grid-template-columns:repeat(3,1fr)}
@media(max-width:900px){.row.c2,.row.c3{grid-template-columns:1fr}}
.chart-wrap{position:relative;width:100%;max-height:340px}
.chart-wrap canvas{width:100%!important;max-height:340px}
.tbl-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch}
table{width:100%;border-collapse:collapse;font-size:.82rem}
thead th{background:var(--bg3);color:var(--txt2);font-weight:600;padding:10px 12px;text-align:left;white-space:nowrap;border-bottom:2px solid var(--border2);font-size:.75rem;text-transform:uppercase;letter-spacing:.04em;position:sticky;top:0;z-index:2}
tbody td{padding:9px 12px;border-bottom:1px solid var(--border);color:var(--txt);vertical-align:middle}
tbody tr:hover{background:rgba(255,255,255,.02)}
td.num{text-align:center;font-variant-numeric:tabular-nums}
tr.row-total td{background:var(--bg3);font-weight:700;border-top:2px solid var(--border2)}
.scroll-box{max-height:280px;overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--border2) transparent}
.scroll-box::-webkit-scrollbar{width:6px}.scroll-box::-webkit-scrollbar-track{background:transparent}.scroll-box::-webkit-scrollbar-thumb{background:var(--border2);border-radius:99px}
.filter-bar{display:flex;align-items:center;gap:10px;margin-bottom:12px;flex-wrap:wrap}
.filter-select{background:var(--bg3);color:var(--txt);border:1px solid var(--border2);border-radius:8px;padding:6px 12px;font-size:.8rem;font-family:var(--font);cursor:pointer;outline:none}
.filter-select:focus{border-color:var(--accent)}
.badge{display:inline-block;padding:2px 10px;border-radius:99px;font-size:.72rem;font-weight:600;white-space:nowrap}
.badge.green{background:rgba(52,211,153,.12);color:var(--green)}
.badge.amber{background:rgba(251,191,36,.12);color:var(--amber)}
.badge.red{background:rgba(248,113,113,.12);color:var(--red)}
.badge.blue{background:rgba(96,165,250,.12);color:var(--accent)}
.badge.purple{background:rgba(167,139,250,.12);color:var(--purple)}
.badge.orange{background:rgba(251,146,60,.12);color:var(--orange)}
.rank-list{list-style:none}
.rank-item{display:flex;align-items:center;gap:12px;padding:10px 14px;border-radius:var(--rad-sm);transition:background .15s}
.rank-item:hover{background:rgba(255,255,255,.03)}
.rank-pos{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;flex-shrink:0}
.rank-pos.gold{background:rgba(251,191,36,.15);color:var(--amber)}
.rank-pos.silver{background:rgba(148,163,184,.12);color:var(--txt2)}
.rank-pos.bronze{background:rgba(251,146,60,.12);color:var(--orange)}
.rank-pos.normal{background:var(--bg3);color:var(--txt3)}
.rank-name{flex:1;font-size:.9rem;font-weight:500;color:var(--txt);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.rank-bar-wrap{flex:0 0 120px;height:6px;background:var(--bg);border-radius:99px;overflow:hidden}
.rank-bar{height:100%;border-radius:99px}
.rank-val{font-size:.9rem;font-weight:700;min-width:40px;text-align:right}
.footer{text-align:center;padding:32px 0;margin-top:48px;border-top:1px solid var(--border);color:var(--txt3);font-size:.78rem}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.anim{animation:fadeUp .5s ease both}.anim-d1{animation-delay:.1s}.anim-d2{animation-delay:.2s}.anim-d3{animation-delay:.3s}.anim-d4{animation-delay:.4s}
@media print{body{background:#fff;color:#1a1a1a;-webkit-print-color-adjust:exact;print-color-adjust:exact}
  .header{background:#1e293b!important}.kpi-card,.card{border:1px solid #ddd;break-inside:avoid}.scroll-box{max-height:none;overflow:visible}}
</style>
<style>
.login-overlay{position:fixed;inset:0;z-index:9999;background:var(--bg);display:flex;align-items:center;justify-content:center;transition:opacity .5s,visibility .5s}
.login-overlay.hidden{opacity:0;visibility:hidden;pointer-events:none}
.login-card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:48px 44px;width:420px;max-width:92vw;text-align:center;box-shadow:0 25px 80px rgba(0,0,0,.5);position:relative;overflow:hidden}
.login-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#60a5fa,#a78bfa,#60a5fa);background-size:200% 100%;animation:shimmer 3s ease infinite}
@keyframes shimmer{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
.login-logo{width:80px;height:80px;border-radius:20px;background:linear-gradient(135deg,#1e293b,#263045);display:flex;align-items:center;justify-content:center;margin:0 auto 24px;font-size:2.5rem;box-shadow:0 8px 32px rgba(0,0,0,.3)}
.login-title{font-family:var(--display);font-size:1.6rem;font-weight:800;color:#fff;margin-bottom:6px}
.login-subtitle{color:var(--txt3);font-size:.88rem;margin-bottom:32px}
.login-input-wrap{position:relative;margin-bottom:20px}
.login-input{width:100%;padding:14px 48px 14px 18px;background:var(--bg);border:1px solid var(--border2);border-radius:12px;color:var(--txt);font-size:1rem;font-family:var(--font);outline:none;transition:border-color .2s,box-shadow .2s}
.login-input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(96,165,250,.15)}
.login-input::placeholder{color:#475569}
.login-eye{position:absolute;right:14px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--txt3);cursor:pointer;font-size:1.1rem;padding:4px}
.login-btn{width:100%;padding:14px;border:none;border-radius:12px;background:linear-gradient(135deg,#3b82f6,#7c3aed);color:#fff;font-size:1rem;font-weight:700;font-family:var(--font);cursor:pointer;transition:transform .15s,box-shadow .2s}
.login-btn:hover{transform:translateY(-1px);box-shadow:0 8px 30px rgba(59,130,246,.3)}
.login-btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
.login-error{color:var(--red);font-size:.82rem;margin-top:12px;min-height:20px}
.login-footer{margin-top:28px;padding-top:20px;border-top:1px solid #1e293b;color:#475569;font-size:.75rem}
#report{display:none;opacity:0;transition:opacity .6s}
#report.visible{display:block;opacity:1}
@media print{.login-overlay{display:none!important}#report{display:block!important;opacity:1!important}}
</style>
</head><body>

<div class="login-overlay" id="loginOverlay">
  <div class="login-card">
    <div class="login-logo">‚öóÔ∏è</div>
    <div class="login-title">Informe de Direcci√≥n</div>
    <div class="login-subtitle">Laboratorio de Calibraci√≥n ¬∑ Metrologic Solutions</div>
    <div class="login-input-wrap">
      <input type="password" class="login-input" id="pwdInput" placeholder="Ingrese la contrase√±a" autocomplete="off">
      <button class="login-eye" id="eyeBtn" type="button">üëÅ</button>
    </div>
    <button class="login-btn" id="loginBtn">Acceder al informe</button>
    <div class="login-error" id="loginError"></div>
    <div class="login-footer"><span>üîí</span> Cifrado AES-256-GCM ¬∑ Solo personal autorizado</div>
  </div>
</div>
<div id="report">

<header class="header"><div class="container header-inner">
  <div><h1>Informe de <span>Direcci√≥n</span></h1><p style="color:var(--txt3);margin-top:6px;font-size:.95rem">Laboratorio de Calibraci√≥n ¬∑ Metrologic Solutions</p></div>
  <div class="header-meta"><div class="periodo" id="periodo"></div><div class="fecha" id="fecha-gen"></div></div>
</div></header>
<main class="container">
  <div class="kpi-grid" id="kpi-grid"></div>
  <section class="section anim anim-d1">
    <div class="section-header"><div class="section-icon green">üìä</div><h2 class="section-title">Calibraciones</h2></div>
    <div class="row c2">
      <div class="card"><div class="card-title">Calibraciones por mes</div><div class="chart-wrap"><canvas id="chart-cal-mes"></canvas></div></div>
      <div class="card"><div class="card-title">T√©cnicos ‚Äî Detalle mensual</div>
        <div class="scroll-box" style="max-height:300px"><div class="tbl-wrap">
          <table id="tbl-tecnicos"><thead><tr id="th-tecnicos"></tr></thead><tbody></tbody></table>
        </div></div></div>
    </div>
  </section>
  <section class="section anim anim-d2">
    <div class="section-header"><div class="section-icon amber">üîß</div><h2 class="section-title">Servicios Pendientes</h2></div>
    <div class="row c2">
      <div class="card"><div class="card-title">Distribuci√≥n por estado</div><div class="chart-wrap" style="max-height:280px"><canvas id="chart-serv"></canvas></div></div>
      <div class="card"><div class="card-title">Detalle de estados</div><ul class="rank-list" id="rank-servicios"></ul></div>
    </div>
  </section>
  <section class="section anim anim-d3">
    <div class="section-header"><div class="section-icon orange">üë•</div><h2 class="section-title">Novedades de Personal</h2></div>
    <div class="row c2">
      <div class="card"><div class="card-title">Horas por tipo de novedad</div><div class="chart-wrap"><canvas id="chart-nov"></canvas></div></div>
      <div class="card"><div class="card-title">Detalle de novedades</div>
        <div class="filter-bar"><label style="font-size:.8rem;color:var(--txt3)">Filtrar:</label><select class="filter-select" id="filtro-nov-tipo"><option value="">Todos los tipos</option></select></div>
        <div class="scroll-box"><div class="tbl-wrap">
          <table id="tbl-novedades"><thead><tr><th>Fecha</th><th>T√©cnico</th><th>Tipo</th><th>Horas</th></tr></thead><tbody></tbody></table>
        </div></div></div>
    </div>
  </section>
  <section class="section anim anim-d4">
    <div class="section-header"><div class="section-icon purple">üìÑ</div><h2 class="section-title">Suplementos de Calibraci√≥n</h2></div>
    <div class="row c3">
      <div class="card"><div class="card-title">Por tipo de error</div><div class="chart-wrap" style="max-height:260px"><canvas id="chart-sup-tipo"></canvas></div></div>
      <div class="card"><div class="card-title">Por fuente de error</div><div class="chart-wrap" style="max-height:260px"><canvas id="chart-sup-fuente"></canvas></div></div>
      <div class="card"><div class="card-title">Top Clientes</div><div class="scroll-box"><ul class="rank-list" id="rank-clientes-sup"></ul></div></div>
    </div>
    <div class="row" style="margin-top:18px"><div class="card"><div class="card-title">Detalle de suplementos</div>
      <div class="scroll-box" style="max-height:320px"><div class="tbl-wrap">
        <table id="tbl-suplementos"><thead><tr><th>Fecha</th><th>Cliente</th><th>N√∫meros</th><th>Cant.</th><th>T√©cnico</th><th>Tipo Error</th><th>Fuente</th><th>Estado</th></tr></thead><tbody></tbody></table>
      </div></div>
    </div></div>
  </section>
</main>
<footer class="footer"><p>Generado autom√°ticamente ¬∑ Dashboard Laboratorio de Calibraci√≥n ¬∑ Metrologic Solutions</p>
<div id="debug-panel" style="margin-top:20px;padding:16px;background:#1a1a2e;border:2px solid #f87171;border-radius:10px;text-align:left;font-size:12px;color:#e2e8f0;font-family:monospace;display:none">
<strong style="color:#f87171">üîç DEBUG ‚Äî Datos que llegaron al navegador:</strong><pre id="debug-data" style="white-space:pre-wrap;max-height:400px;overflow:auto;margin-top:8px"></pre>
</div>
<p style="margin-top:8px;font-size:11px"><a href="#" onclick="document.getElementById('debug-panel').style.display=document.getElementById('debug-panel').style.display==='none'?'block':'none';return false" style="color:#64748b">Toggle Debug</a></p>
</footer>

</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>

const $=s=>document.querySelector(s);
const palette={green:['#34d399','#059669','#047857','#065f46','#064e3b'],blue:['#60a5fa','#3b82f6','#2563eb','#1d4ed8','#1e40af'],amber:['#fbbf24','#f59e0b','#d97706','#b45309','#92400e'],orange:['#fb923c','#f97316','#ea580c','#c2410c','#9a3412'],purple:['#a78bfa','#8b5cf6','#7c3aed','#6d28d9','#5b21b6'],mixed:['#34d399','#60a5fa','#fbbf24','#fb923c','#a78bfa','#f87171','#38bdf8','#4ade80','#facc15','#c084fc']};
const rankClass=i=>i===0?'gold':i===1?'silver':i===2?'bronze':'normal';
function badgeFor(t){t=(t||'').toLowerCase();if(t.includes('cliente'))return'blue';if(t.includes('laboratorio'))return'red';if(t.includes('pendiente'))return'amber';if(t.includes('enviado')||t.includes('complet'))return'green';if(t.includes('proceso'))return'orange';return'purple'}

function renderReport(D){
  console.log('=== RENDER REPORT START ===');
  console.log('FULL DATA:', JSON.stringify(D));
  console.log('SUPLEMENTOS:', JSON.stringify(D.suplementos));
  console.log('SUPLEMENTOS por_fuente:', JSON.stringify(D.suplementos.por_fuente));
  console.log('SUPLEMENTOS top_clientes:', JSON.stringify(D.suplementos.top_clientes));
  console.log('SUPLEMENTOS detalle:', D.suplementos.detalle ? D.suplementos.detalle.length : 'NULL');

  Chart.defaults.color='#94a3b8';Chart.defaults.borderColor='#263045';Chart.defaults.font.family="'DM Sans',system-ui,sans-serif";

  try {
  $('#periodo').textContent='\u{1F4C6}  '+(D.meta.periodo||D.meta.anio);
  $('#fecha-gen').textContent='Generado: '+D.meta.generado;
  } catch(e){console.error('ERROR meta:',e)}

  try {
  [{cls:'cal',label:'Calibraciones',value:D.kpis.calibraciones,sub:D.kpis.tecnicos+' t√©cnicos'},
   {cls:'tec',label:'T√©cnicos Activos',value:D.kpis.tecnicos,sub:D.kpis.calibraciones>0&&D.kpis.tecnicos>0?'~'+(D.kpis.calibraciones/D.kpis.tecnicos).toFixed(0)+' cal/t√©c':''},
   {cls:'serv',label:'Serv. Pendientes',value:D.kpis.servicios,sub:D.servicios.total_registros+' registros'},
   {cls:'nov',label:'Novedades',value:D.kpis.novedades,sub:D.kpis.horas_novedades+'h totales'},
   {cls:'sup',label:'Suplementos',value:D.kpis.suplementos,sub:D.suplementos.total_cantidad+' certificados'}
  ].forEach((k,i)=>{$('#kpi-grid').innerHTML+=`<div class="kpi-card ${k.cls} anim" style="animation-delay:${i*.07+.1}s"><div class="kpi-label">${k.label}</div><div class="kpi-value">${k.value.toLocaleString('es-CO')}</div><div class="kpi-sub">${k.sub}</div></div>`});
  } catch(e){console.error('ERROR kpis:',e)}

  // CHART: Cal por mes
  try {
  const cm=D.calibraciones.por_mes||[];
  if(cm.length){new Chart($('#chart-cal-mes'),{type:'bar',data:{labels:cm.map(m=>m.mes),datasets:[{data:cm.map(m=>m.cantidad),backgroundColor:cm.map((_,i)=>palette.green[i%5]+'cc'),borderColor:cm.map((_,i)=>palette.green[i%5]),borderWidth:1,borderRadius:6,maxBarThickness:48}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,grid:{color:'#1a2234'}},x:{grid:{display:false}}}}})}
  } catch(e){console.error('ERROR chart-cal-mes:',e)}

  // TABLE: Tecnicos mes a mes
  try {
  const ptm=D.calibraciones.por_tecnico_mes||[];
  const meses=D.calibraciones.meses_disponibles||[];
  if(ptm.length){
    const thR=$('#th-tecnicos');
    thR.innerHTML='<th style="position:sticky;left:0;z-index:3;background:var(--bg3)">#</th><th style="position:sticky;left:28px;z-index:3;background:var(--bg3);min-width:120px">T√©cnico</th>';
    meses.forEach(m=>{thR.innerHTML+=`<th class="num">${m}</th>`});
    thR.innerHTML+='<th class="num" style="color:var(--green)">Total</th>';
    const tb=$('#tbl-tecnicos tbody');
    ptm.forEach((t,i)=>{
      let r=`<td style="position:sticky;left:0;background:var(--card);font-weight:600;color:var(--txt3)">${i+1}</td>`;
      r+=`<td style="position:sticky;left:28px;background:var(--card);white-space:nowrap">${t.nombre}</td>`;
      meses.forEach(m=>{const v=t.meses[m]||0;r+=`<td class="num" style="color:${v>0?'var(--txt)':'var(--txt3)'}">${v||'-'}</td>`});
      r+=`<td class="num" style="font-weight:700;color:var(--green)">${t.total}</td>`;
      tb.innerHTML+=`<tr>${r}</tr>`;
    });
    let tot='<td style="position:sticky;left:0;background:var(--bg3)"></td><td style="position:sticky;left:28px;background:var(--bg3);font-weight:700">TOTAL</td>';
    meses.forEach(m=>{const s=ptm.reduce((a,t)=>a+(t.meses[m]||0),0);tot+=`<td class="num">${s}</td>`});
    tot+=`<td class="num" style="color:var(--green)">${ptm.reduce((a,t)=>a+t.total,0)}</td>`;
    tb.innerHTML+=`<tr class="row-total">${tot}</tr>`;
  }
  } catch(e){console.error('ERROR tecnicos:',e)}

  // SERVICIOS
  try {
  const sd=D.servicios.por_estado||[];
  if(sd.length){new Chart($('#chart-serv'),{type:'doughnut',data:{labels:sd.map(s=>s.estado),datasets:[{data:sd.map(s=>s.cantidad),backgroundColor:sd.map((_,i)=>palette.mixed[i%palette.mixed.length]+'dd'),borderColor:'#161e2e',borderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,cutout:'55%',plugins:{legend:{position:'bottom',labels:{padding:14,usePointStyle:true,font:{size:11}}}}}})}
  const mxS=sd.length?Math.max(...sd.map(s=>s.cantidad)):1;
  sd.forEach((s,i)=>{const p=(s.cantidad/mxS*100).toFixed(0);$('#rank-servicios').innerHTML+=`<li class="rank-item"><span class="rank-pos ${rankClass(i)}">${i+1}</span><span class="rank-name">${s.estado}</span><span class="rank-bar-wrap"><span class="rank-bar" style="width:${p}%;background:${palette.amber[Math.min(i,4)]}"></span></span><span class="rank-val" style="color:${palette.amber[0]}">${s.cantidad}</span></li>`});
  } catch(e){console.error('ERROR servicios:',e)}

  // NOVEDADES
  try {
  const nd=D.novedades.por_tipo||[];
  if(nd.length){new Chart($('#chart-nov'),{type:'bar',data:{labels:nd.map(n=>n.tipo),datasets:[{label:'Horas',data:nd.map(n=>n.horas),backgroundColor:palette.orange[0]+'bb',borderColor:palette.orange[0],borderWidth:1,borderRadius:6,yAxisID:'y'},{label:'Cantidad',data:nd.map(n=>n.cantidad),backgroundColor:palette.blue[0]+'88',borderColor:palette.blue[0],borderWidth:1,borderRadius:6,yAxisID:'y1'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{usePointStyle:true,font:{size:11}}}},scales:{y:{beginAtZero:true,position:'left',grid:{color:'#1a2234'},title:{display:true,text:'Horas',font:{size:11}}},y1:{beginAtZero:true,position:'right',grid:{drawOnChartArea:false},title:{display:true,text:'Cantidad',font:{size:11}}},x:{grid:{display:false},ticks:{maxRotation:45,font:{size:10}}}}}})}
  } catch(e){console.error('ERROR chart-nov:',e)}

  // TABLE: Novedades con filtro
  try {
  const allNov=D.novedades.detalle||[];
  const tipos=new Set(allNov.map(n=>n.tipo));
  const selN=$('#filtro-nov-tipo');
  tipos.forEach(t=>{const o=document.createElement('option');o.value=t;o.textContent=t;selN.appendChild(o)});
  function rNov(f){const tn=$('#tbl-novedades tbody');tn.innerHTML='';const l=f?allNov.filter(n=>n.tipo===f):allNov;l.forEach(n=>{tn.innerHTML+=`<tr><td>${n.fecha}</td><td>${n.tecnico}</td><td><span class="badge orange">${n.tipo}</span></td><td style="font-weight:600">${n.horas}h</td></tr>`});if(!l.length)tn.innerHTML='<tr><td colspan="4" style="text-align:center;color:var(--txt3)">Sin novedades</td></tr>'}
  rNov('');selN.addEventListener('change',()=>rNov(selN.value));
  } catch(e){console.error('ERROR novedades:',e)}

  // SUPLEMENTOS
  console.log('=== RENDERING SUPLEMENTOS ===');

  // Chart: Por tipo de error
  try {
  const st=D.suplementos.por_tipo_error||[];
  console.log('por_tipo_error count:', st.length, st);
  if(st.length){new Chart($('#chart-sup-tipo'),{type:'doughnut',data:{labels:st.map(s=>s.tipo),datasets:[{data:st.map(s=>s.cantidad),backgroundColor:st.map((_,i)=>palette.mixed[i%palette.mixed.length]+'dd'),borderColor:'#161e2e',borderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,cutout:'50%',plugins:{legend:{position:'bottom',labels:{padding:10,usePointStyle:true,font:{size:10}}}}}})}
  } catch(e){console.error('ERROR chart-sup-tipo:',e)}

  // Chart: Por fuente de error
  try {
  const sf=D.suplementos.por_fuente||[];
  console.log('por_fuente count:', sf.length, sf);
  if(sf.length){
    const colores=sf.map((_,i)=>palette.mixed[i%palette.mixed.length]+'dd');
    new Chart($('#chart-sup-fuente'),{type:'doughnut',data:{labels:sf.map(s=>s.fuente),datasets:[{data:sf.map(s=>s.cantidad),backgroundColor:colores,borderColor:'#161e2e',borderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,cutout:'50%',plugins:{legend:{position:'bottom',labels:{padding:10,usePointStyle:true,font:{size:10}}}}}});
  } else {
    console.warn('por_fuente EMPTY - no chart rendered');
  }
  } catch(e){console.error('ERROR chart-sup-fuente:',e)}

  // TOP Clientes
  try {
  const tc=D.suplementos.top_clientes||[];
  console.log('top_clientes count:', tc.length, tc);
  const mxC=tc.length?tc[0].cantidad:1;const rc=$('#rank-clientes-sup');
  tc.forEach((c,i)=>{const p=(c.cantidad/mxC*100).toFixed(0);rc.innerHTML+=`<li class="rank-item"><span class="rank-pos ${rankClass(i)}">${i+1}</span><span class="rank-name">${c.cliente}</span><span class="rank-bar-wrap"><span class="rank-bar" style="width:${p}%;background:${palette.purple[Math.min(i,4)]}"></span></span><span class="rank-val" style="color:${palette.purple[0]}">${c.cantidad}</span></li>`});
  if(!tc.length){rc.innerHTML='<li style="color:var(--txt3);padding:20px;text-align:center">Sin datos de clientes</li>';console.warn('top_clientes EMPTY');}
  } catch(e){console.error('ERROR top_clientes:',e)}

  // TABLE: Detalle Suplementos
  try {
  const tsSup=$('#tbl-suplementos tbody');
  const supD=D.suplementos.detalle||[];
  console.log('detalle count:', supD.length, supD.length>0?supD[0]:'NO DATA');
  supD.forEach(s=>{tsSup.innerHTML+=`<tr><td>${s.fecha||''}</td><td>${s.cliente||''}</td><td>${s.numeros||''}</td><td class="num">${s.cantidad||1}</td><td>${s.tecnico||''}</td><td><span class="badge ${badgeFor(s.tipo_error)}">${s.tipo_error||'-'}</span></td><td><span class="badge ${badgeFor(s.fuente)}">${s.fuente||'-'}</span></td><td><span class="badge ${badgeFor(s.estado)}">${s.estado||'-'}</span></td></tr>`});
  if(!supD.length){tsSup.innerHTML='<tr><td colspan="8" style="text-align:center;color:var(--txt3)">Sin suplementos registrados</td></tr>';console.warn('detalle EMPTY');}
  } catch(e){console.error('ERROR detalle suplementos:',e)}

  console.log('=== RENDER REPORT COMPLETE ===');

  // Populate debug panel
  try {
    const dp=document.getElementById('debug-data');
    if(dp){
      const info = {
        'suplementos.total': D.suplementos.total,
        'suplementos.total_cantidad': D.suplementos.total_cantidad,
        'suplementos.por_tipo_error': (D.suplementos.por_tipo_error||[]).length + ' items ‚Üí ' + JSON.stringify(D.suplementos.por_tipo_error||[]),
        'suplementos.por_fuente': (D.suplementos.por_fuente||[]).length + ' items ‚Üí ' + JSON.stringify(D.suplementos.por_fuente||[]),
        'suplementos.top_clientes': (D.suplementos.top_clientes||[]).length + ' items ‚Üí ' + JSON.stringify(D.suplementos.top_clientes||[]),
        'suplementos.detalle': (D.suplementos.detalle||[]).length + ' rows',
        'suplementos.detalle[0]': JSON.stringify((D.suplementos.detalle||[])[0]||'NO DATA'),
        '---': '---',
        'calibraciones.por_tecnico_mes': (D.calibraciones.por_tecnico_mes||[]).length + ' tecnicos',
        'calibraciones.meses_disponibles': JSON.stringify(D.calibraciones.meses_disponibles||[]),
        'novedades.detalle': (D.novedades.detalle||[]).length + ' rows',
        'ALL_KEYS': Object.keys(D.suplementos).join(', '),
      };
      dp.textContent = Object.entries(info).map(([k,v])=>k+': '+v).join('\n');
    }
  } catch(e){console.error('debug panel error',e)}
}


const ENC = {"salt": "5LjET+yHmdjAwo/lIGmEBQ==", "iv": "myZuMMXDtVKp4QLD", "ciphertext": "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"};
async function decryptData(password){
  const salt=Uint8Array.from(atob(ENC.salt),c=>c.charCodeAt(0));
  const iv=Uint8Array.from(atob(ENC.iv),c=>c.charCodeAt(0));
  const ct=Uint8Array.from(atob(ENC.ciphertext),c=>c.charCodeAt(0));
  const enc=new TextEncoder();
  const km=await crypto.subtle.importKey("raw",enc.encode(password),"PBKDF2",false,["deriveKey"]);
  const key=await crypto.subtle.deriveKey({name:"PBKDF2",salt:salt,iterations:100000,hash:"SHA-256"},km,{name:"AES-GCM",length:256},false,["decrypt"]);
  const dec=await crypto.subtle.decrypt({name:"AES-GCM",iv:iv},key,ct);
  return JSON.parse(new TextDecoder().decode(dec));
}
const eyeBtn=document.getElementById('eyeBtn'),pwdInput=document.getElementById('pwdInput'),loginBtn=document.getElementById('loginBtn'),errEl=document.getElementById('loginError');
eyeBtn.addEventListener('click',()=>{if(pwdInput.type==='password'){pwdInput.type='text';eyeBtn.textContent='üîí'}else{pwdInput.type='password';eyeBtn.textContent='üëÅ'}});
pwdInput.addEventListener('keydown',e=>{if(e.key==='Enter')auth()});
loginBtn.addEventListener('click',auth);
async function auth(){
  const pwd=pwdInput.value;if(!pwd){errEl.textContent='Ingrese la contrase√±a';return}
  loginBtn.disabled=true;loginBtn.textContent='Descifrando...';errEl.textContent='';
  try{const D=await decryptData(pwd);document.getElementById('loginOverlay').classList.add('hidden');
    const r=document.getElementById('report');r.style.display='block';setTimeout(()=>r.classList.add('visible'),50);
    renderReport(D);
  }catch(e){errEl.textContent='‚ùå Contrase√±a incorrecta';loginBtn.disabled=false;loginBtn.textContent='Acceder al informe';pwdInput.select()}
}
</script></body></html>