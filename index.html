<!DOCTYPE html>
<html lang="es"><head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0">
<title>Informe de Direcci√≥n ‚Äî Laboratorio de Calibraci√≥n</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,500;9..40,700&family=Playfair+Display:wght@600;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#0b0f19;--bg2:#111827;--bg3:#1a2234;--card:#161e2e;
  --border:#263045;--border2:#334155;
  --txt:#e2e8f0;--txt2:#94a3b8;--txt3:#64748b;
  --accent:#60a5fa;--accent2:#3b82f6;--green:#34d399;--green2:#059669;
  --amber:#fbbf24;--amber2:#d97706;--red:#f87171;--red2:#dc2626;
  --purple:#a78bfa;--purple2:#7c3aed;--orange:#fb923c;--orange2:#ea580c;
  --font:'DM Sans',system-ui,-apple-system,sans-serif;
  --display:'Playfair Display',Georgia,serif;
  --rad:14px;--rad-sm:10px;
}
html{scroll-behavior:smooth;-webkit-text-size-adjust:100%}
body{font-family:var(--font);background:var(--bg);color:var(--txt);line-height:1.6;min-height:100vh;
  background-image:radial-gradient(ellipse 80% 50% at 50% -20%,rgba(59,130,246,.08),transparent),
    radial-gradient(ellipse 60% 40% at 100% 0%,rgba(124,58,237,.05),transparent)}
.container{max-width:1320px;margin:0 auto;padding:0 24px}
@media(max-width:768px){.container{padding:0 14px}}
.header{background:linear-gradient(135deg,#0f172a 0%,#1e293b 50%,#0f172a 100%);border-bottom:1px solid var(--border);padding:40px 0 32px;position:relative;overflow:hidden}
.header::before{content:'';position:absolute;top:-60%;right:-10%;width:500px;height:500px;background:radial-gradient(circle,rgba(96,165,250,.08),transparent 70%);pointer-events:none}
.header-inner{display:flex;justify-content:space-between;align-items:flex-end;flex-wrap:wrap;gap:16px}
.header h1{font-family:var(--display);font-size:clamp(1.6rem,4vw,2.5rem);font-weight:800;letter-spacing:-.02em;color:#fff;line-height:1.15}
.header h1 span{background:linear-gradient(135deg,var(--accent),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.header-meta{text-align:right}
.header-meta .periodo{font-size:1.05rem;font-weight:700;color:var(--accent);background:rgba(96,165,250,.1);padding:6px 16px;border-radius:999px;border:1px solid rgba(96,165,250,.2);display:inline-block}
.header-meta .fecha{font-size:.82rem;color:var(--txt3);margin-top:8px}
.kpi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;margin:28px 0 36px}
.kpi-card{background:var(--card);border:1px solid var(--border);border-radius:var(--rad);padding:20px 18px;position:relative;overflow:hidden;transition:transform .2s}
.kpi-card:hover{transform:translateY(-3px)}
.kpi-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;border-radius:var(--rad) var(--rad) 0 0}
.kpi-card.cal::before{background:linear-gradient(90deg,var(--green),var(--green2))}
.kpi-card.tec::before{background:linear-gradient(90deg,var(--accent),var(--accent2))}
.kpi-card.serv::before{background:linear-gradient(90deg,var(--amber),var(--amber2))}
.kpi-card.nov::before{background:linear-gradient(90deg,var(--orange),var(--orange2))}
.kpi-card.sup::before{background:linear-gradient(90deg,var(--purple),var(--purple2))}
.kpi-label{font-size:.78rem;font-weight:500;color:var(--txt3);text-transform:uppercase;letter-spacing:.06em}
.kpi-value{font-family:var(--display);font-size:2.2rem;font-weight:800;line-height:1.1;margin:6px 0 2px}
.kpi-card.cal .kpi-value{color:var(--green)}.kpi-card.tec .kpi-value{color:var(--accent)}
.kpi-card.serv .kpi-value{color:var(--amber)}.kpi-card.nov .kpi-value{color:var(--orange)}
.kpi-card.sup .kpi-value{color:var(--purple)}
.kpi-sub{font-size:.78rem;color:var(--txt3)}
.section{margin-bottom:36px}
.section-header{display:flex;align-items:center;gap:12px;margin-bottom:18px;padding-bottom:12px;border-bottom:1px solid var(--border)}
.section-icon{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;flex-shrink:0}
.section-icon.green{background:rgba(52,211,153,.12);color:var(--green)}
.section-icon.amber{background:rgba(251,191,36,.12);color:var(--amber)}
.section-icon.orange{background:rgba(251,146,60,.12);color:var(--orange)}
.section-icon.purple{background:rgba(167,139,250,.12);color:var(--purple)}
.section-title{font-family:var(--display);font-size:1.35rem;font-weight:600;color:#fff}
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--rad);padding:24px}
.card-title{font-size:.85rem;font-weight:700;color:var(--txt2);text-transform:uppercase;letter-spacing:.04em;margin-bottom:16px}
.row{display:grid;gap:18px}.row.c2{grid-template-columns:repeat(2,1fr)}.row.c3{grid-template-columns:repeat(3,1fr)}
@media(max-width:900px){.row.c2,.row.c3{grid-template-columns:1fr}}
.chart-wrap{position:relative;width:100%;max-height:340px}
.chart-wrap canvas{width:100%!important;max-height:340px}
.tbl-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch}
table{width:100%;border-collapse:collapse;font-size:.82rem}
thead th{background:var(--bg3);color:var(--txt2);font-weight:600;padding:10px 12px;text-align:left;white-space:nowrap;border-bottom:2px solid var(--border2);font-size:.75rem;text-transform:uppercase;letter-spacing:.04em;position:sticky;top:0;z-index:2}
tbody td{padding:9px 12px;border-bottom:1px solid var(--border);color:var(--txt);vertical-align:middle}
tbody tr:hover{background:rgba(255,255,255,.02)}
td.num{text-align:center;font-variant-numeric:tabular-nums}
tr.row-total td{background:var(--bg3);font-weight:700;border-top:2px solid var(--border2)}
.scroll-box{max-height:280px;overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--border2) transparent}
.scroll-box::-webkit-scrollbar{width:6px}.scroll-box::-webkit-scrollbar-track{background:transparent}.scroll-box::-webkit-scrollbar-thumb{background:var(--border2);border-radius:99px}
.filter-bar{display:flex;align-items:center;gap:10px;margin-bottom:12px;flex-wrap:wrap}
.filter-select{background:var(--bg3);color:var(--txt);border:1px solid var(--border2);border-radius:8px;padding:6px 12px;font-size:.8rem;font-family:var(--font);cursor:pointer;outline:none}
.filter-select:focus{border-color:var(--accent)}
.badge{display:inline-block;padding:2px 10px;border-radius:99px;font-size:.72rem;font-weight:600;white-space:nowrap}
.badge.green{background:rgba(52,211,153,.12);color:var(--green)}
.badge.amber{background:rgba(251,191,36,.12);color:var(--amber)}
.badge.red{background:rgba(248,113,113,.12);color:var(--red)}
.badge.blue{background:rgba(96,165,250,.12);color:var(--accent)}
.badge.purple{background:rgba(167,139,250,.12);color:var(--purple)}
.badge.orange{background:rgba(251,146,60,.12);color:var(--orange)}
.rank-list{list-style:none}
.rank-item{display:flex;align-items:center;gap:12px;padding:10px 14px;border-radius:var(--rad-sm);transition:background .15s}
.rank-item:hover{background:rgba(255,255,255,.03)}
.rank-pos{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;flex-shrink:0}
.rank-pos.gold{background:rgba(251,191,36,.15);color:var(--amber)}
.rank-pos.silver{background:rgba(148,163,184,.12);color:var(--txt2)}
.rank-pos.bronze{background:rgba(251,146,60,.12);color:var(--orange)}
.rank-pos.normal{background:var(--bg3);color:var(--txt3)}
.rank-name{flex:1;font-size:.9rem;font-weight:500;color:var(--txt);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.rank-bar-wrap{flex:0 0 120px;height:6px;background:var(--bg);border-radius:99px;overflow:hidden}
.rank-bar{height:100%;border-radius:99px}
.rank-val{font-size:.9rem;font-weight:700;min-width:40px;text-align:right}
.footer{text-align:center;padding:32px 0;margin-top:48px;border-top:1px solid var(--border);color:var(--txt3);font-size:.78rem}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.anim{animation:fadeUp .5s ease both}.anim-d1{animation-delay:.1s}.anim-d2{animation-delay:.2s}.anim-d3{animation-delay:.3s}.anim-d4{animation-delay:.4s}
@media print{body{background:#fff;color:#1a1a1a;-webkit-print-color-adjust:exact;print-color-adjust:exact}
  .header{background:#1e293b!important}.kpi-card,.card{border:1px solid #ddd;break-inside:avoid}.scroll-box{max-height:none;overflow:visible}}
</style>
<style>
.login-overlay{position:fixed;inset:0;z-index:9999;background:var(--bg);display:flex;align-items:center;justify-content:center;transition:opacity .5s,visibility .5s}
.login-overlay.hidden{opacity:0;visibility:hidden;pointer-events:none}
.login-card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:48px 44px;width:420px;max-width:92vw;text-align:center;box-shadow:0 25px 80px rgba(0,0,0,.5);position:relative;overflow:hidden}
.login-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#60a5fa,#a78bfa,#60a5fa);background-size:200% 100%;animation:shimmer 3s ease infinite}
@keyframes shimmer{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
.login-logo{width:80px;height:80px;border-radius:20px;background:linear-gradient(135deg,#1e293b,#263045);display:flex;align-items:center;justify-content:center;margin:0 auto 24px;font-size:2.5rem;box-shadow:0 8px 32px rgba(0,0,0,.3)}
.login-title{font-family:var(--display);font-size:1.6rem;font-weight:800;color:#fff;margin-bottom:6px}
.login-subtitle{color:var(--txt3);font-size:.88rem;margin-bottom:32px}
.login-input-wrap{position:relative;margin-bottom:20px}
.login-input{width:100%;padding:14px 48px 14px 18px;background:var(--bg);border:1px solid var(--border2);border-radius:12px;color:var(--txt);font-size:1rem;font-family:var(--font);outline:none;transition:border-color .2s,box-shadow .2s}
.login-input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(96,165,250,.15)}
.login-input::placeholder{color:#475569}
.login-eye{position:absolute;right:14px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--txt3);cursor:pointer;font-size:1.1rem;padding:4px}
.login-btn{width:100%;padding:14px;border:none;border-radius:12px;background:linear-gradient(135deg,#3b82f6,#7c3aed);color:#fff;font-size:1rem;font-weight:700;font-family:var(--font);cursor:pointer;transition:transform .15s,box-shadow .2s}
.login-btn:hover{transform:translateY(-1px);box-shadow:0 8px 30px rgba(59,130,246,.3)}
.login-btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
.login-error{color:var(--red);font-size:.82rem;margin-top:12px;min-height:20px}
.login-footer{margin-top:28px;padding-top:20px;border-top:1px solid #1e293b;color:#475569;font-size:.75rem}
#report{display:none;opacity:0;transition:opacity .6s}
#report.visible{display:block;opacity:1}
@media print{.login-overlay{display:none!important}#report{display:block!important;opacity:1!important}}
</style>
</head><body>

<div class="login-overlay" id="loginOverlay">
  <div class="login-card">
    <div class="login-logo">‚öóÔ∏è</div>
    <div class="login-title">Informe de Direcci√≥n</div>
    <div class="login-subtitle">Laboratorio de Calibraci√≥n ¬∑ Metrologic Solutions</div>
    <div class="login-input-wrap">
      <input type="password" class="login-input" id="pwdInput" placeholder="Ingrese la contrase√±a" autocomplete="off">
      <button class="login-eye" id="eyeBtn" type="button">üëÅ</button>
    </div>
    <button class="login-btn" id="loginBtn">Acceder al informe</button>
    <div class="login-error" id="loginError"></div>
    <div class="login-footer"><span>üîí</span> Cifrado AES-256-GCM ¬∑ Solo personal autorizado</div>
  </div>
</div>
<div id="report">

<header class="header"><div class="container header-inner">
  <div><h1>Informe de <span>Direcci√≥n</span></h1><p style="color:var(--txt3);margin-top:6px;font-size:.95rem">Laboratorio de Calibraci√≥n ¬∑ Metrologic Solutions</p></div>
  <div class="header-meta"><div class="periodo" id="periodo"></div><div class="fecha" id="fecha-gen"></div></div>
</div></header>
<main class="container">
  <div class="kpi-grid" id="kpi-grid"></div>
  <section class="section anim anim-d1">
    <div class="section-header"><div class="section-icon green">üìä</div><h2 class="section-title">Calibraciones</h2></div>
    <div class="row c2">
      <div class="card"><div class="card-title">Calibraciones por mes</div><div class="chart-wrap"><canvas id="chart-cal-mes"></canvas></div></div>
      <div class="card"><div class="card-title">T√©cnicos ‚Äî Detalle mensual</div>
        <div class="scroll-box" style="max-height:300px"><div class="tbl-wrap">
          <table id="tbl-tecnicos"><thead><tr id="th-tecnicos"></tr></thead><tbody></tbody></table>
        </div></div></div>
    </div>
  </section>
  <section class="section anim anim-d2">
    <div class="section-header"><div class="section-icon amber">üîß</div><h2 class="section-title">Servicios Pendientes</h2></div>
    <div class="row c2">
      <div class="card"><div class="card-title">Distribuci√≥n por estado</div><div class="chart-wrap" style="max-height:280px"><canvas id="chart-serv"></canvas></div></div>
      <div class="card"><div class="card-title">Detalle de estados</div><ul class="rank-list" id="rank-servicios"></ul></div>
    </div>
  </section>
  <section class="section anim anim-d3">
    <div class="section-header"><div class="section-icon orange">üë•</div><h2 class="section-title">Novedades de Personal</h2></div>
    <div class="row c2">
      <div class="card"><div class="card-title">Horas por tipo de novedad</div><div class="chart-wrap"><canvas id="chart-nov"></canvas></div></div>
      <div class="card"><div class="card-title">Detalle de novedades</div>
        <div class="filter-bar"><label style="font-size:.8rem;color:var(--txt3)">Filtrar:</label><select class="filter-select" id="filtro-nov-tipo"><option value="">Todos los tipos</option></select></div>
        <div class="scroll-box"><div class="tbl-wrap">
          <table id="tbl-novedades"><thead><tr><th>Fecha</th><th>T√©cnico</th><th>Tipo</th><th>Horas</th></tr></thead><tbody></tbody></table>
        </div></div></div>
    </div>
  </section>
  <section class="section anim anim-d4">
    <div class="section-header"><div class="section-icon purple">üìÑ</div><h2 class="section-title">Suplementos de Calibraci√≥n</h2></div>
    <div class="row c3">
      <div class="card"><div class="card-title">Por tipo de error</div><div class="chart-wrap" style="max-height:260px"><canvas id="chart-sup-tipo"></canvas></div></div>
      <div class="card"><div class="card-title">Por fuente de error</div><div class="chart-wrap" style="max-height:260px"><canvas id="chart-sup-fuente"></canvas></div></div>
      <div class="card"><div class="card-title">Top Clientes</div><div class="scroll-box"><ul class="rank-list" id="rank-clientes-sup"></ul></div></div>
    </div>
    <div class="row" style="margin-top:18px"><div class="card"><div class="card-title">Detalle de suplementos</div>
      <div class="scroll-box" style="max-height:320px"><div class="tbl-wrap">
        <table id="tbl-suplementos"><thead><tr><th>Fecha</th><th>Cliente</th><th>N√∫meros</th><th>Cant.</th><th>T√©cnico</th><th>Tipo Error</th><th>Fuente</th><th>Estado</th></tr></thead><tbody></tbody></table>
      </div></div>
    </div></div>
  </section>
</main>
<footer class="footer"><p>Generado autom√°ticamente ¬∑ Dashboard Laboratorio de Calibraci√≥n ¬∑ Metrologic Solutions</p></footer>

</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>

const $=s=>document.querySelector(s);
const palette={green:['#34d399','#059669','#047857','#065f46','#064e3b'],blue:['#60a5fa','#3b82f6','#2563eb','#1d4ed8','#1e40af'],amber:['#fbbf24','#f59e0b','#d97706','#b45309','#92400e'],orange:['#fb923c','#f97316','#ea580c','#c2410c','#9a3412'],purple:['#a78bfa','#8b5cf6','#7c3aed','#6d28d9','#5b21b6'],mixed:['#34d399','#60a5fa','#fbbf24','#fb923c','#a78bfa','#f87171','#38bdf8','#4ade80','#facc15','#c084fc']};
const rankClass=i=>i===0?'gold':i===1?'silver':i===2?'bronze':'normal';
function badgeFor(t){t=(t||'').toLowerCase();if(t.includes('cliente'))return'blue';if(t.includes('laboratorio'))return'red';if(t.includes('pendiente'))return'amber';if(t.includes('enviado')||t.includes('complet'))return'green';if(t.includes('proceso'))return'orange';return'purple'}

function renderReport(D){
  Chart.defaults.color='#94a3b8';Chart.defaults.borderColor='#263045';Chart.defaults.font.family="'DM Sans',system-ui,sans-serif";
  $('#periodo').textContent='\u{1F4C6}  '+(D.meta.periodo||D.meta.anio);
  $('#fecha-gen').textContent='Generado: '+D.meta.generado;

  [{cls:'cal',label:'Calibraciones',value:D.kpis.calibraciones,sub:D.kpis.tecnicos+' t√©cnicos'},
   {cls:'tec',label:'T√©cnicos Activos',value:D.kpis.tecnicos,sub:D.kpis.calibraciones>0&&D.kpis.tecnicos>0?'~'+(D.kpis.calibraciones/D.kpis.tecnicos).toFixed(0)+' cal/t√©c':''},
   {cls:'serv',label:'Serv. Pendientes',value:D.kpis.servicios,sub:D.servicios.total_registros+' registros'},
   {cls:'nov',label:'Novedades',value:D.kpis.novedades,sub:D.kpis.horas_novedades+'h totales'},
   {cls:'sup',label:'Suplementos',value:D.kpis.suplementos,sub:D.suplementos.total_cantidad+' certificados'}
  ].forEach((k,i)=>{$('#kpi-grid').innerHTML+=`<div class="kpi-card ${k.cls} anim" style="animation-delay:${i*.07+.1}s"><div class="kpi-label">${k.label}</div><div class="kpi-value">${k.value.toLocaleString('es-CO')}</div><div class="kpi-sub">${k.sub}</div></div>`});

  // CHART: Cal por mes
  const cm=D.calibraciones.por_mes;
  if(cm.length){new Chart($('#chart-cal-mes'),{type:'bar',data:{labels:cm.map(m=>m.mes),datasets:[{data:cm.map(m=>m.cantidad),backgroundColor:cm.map((_,i)=>palette.green[i%5]+'cc'),borderColor:cm.map((_,i)=>palette.green[i%5]),borderWidth:1,borderRadius:6,maxBarThickness:48}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,grid:{color:'#1a2234'}},x:{grid:{display:false}}}}})}

  // TABLE: Tecnicos mes a mes
  const ptm=D.calibraciones.por_tecnico_mes||[];
  const meses=D.calibraciones.meses_disponibles||[];
  if(ptm.length){
    const thR=$('#th-tecnicos');
    thR.innerHTML='<th style="position:sticky;left:0;z-index:3;background:var(--bg3)">#</th><th style="position:sticky;left:28px;z-index:3;background:var(--bg3);min-width:120px">T√©cnico</th>';
    meses.forEach(m=>{thR.innerHTML+=`<th class="num">${m}</th>`});
    thR.innerHTML+='<th class="num" style="color:var(--green)">Total</th>';
    const tb=$('#tbl-tecnicos tbody');
    ptm.forEach((t,i)=>{
      let r=`<td style="position:sticky;left:0;background:var(--card);font-weight:600;color:var(--txt3)">${i+1}</td>`;
      r+=`<td style="position:sticky;left:28px;background:var(--card);white-space:nowrap">${t.nombre}</td>`;
      meses.forEach(m=>{const v=t.meses[m]||0;r+=`<td class="num" style="color:${v>0?'var(--txt)':'var(--txt3)'}">${v||'-'}</td>`});
      r+=`<td class="num" style="font-weight:700;color:var(--green)">${t.total}</td>`;
      tb.innerHTML+=`<tr>${r}</tr>`;
    });
    let tot='<td style="position:sticky;left:0;background:var(--bg3)"></td><td style="position:sticky;left:28px;background:var(--bg3);font-weight:700">TOTAL</td>';
    meses.forEach(m=>{const s=ptm.reduce((a,t)=>a+(t.meses[m]||0),0);tot+=`<td class="num">${s}</td>`});
    tot+=`<td class="num" style="color:var(--green)">${ptm.reduce((a,t)=>a+t.total,0)}</td>`;
    tb.innerHTML+=`<tr class="row-total">${tot}</tr>`;
  }

  // SERVICIOS
  const sd=D.servicios.por_estado;
  if(sd.length){new Chart($('#chart-serv'),{type:'doughnut',data:{labels:sd.map(s=>s.estado),datasets:[{data:sd.map(s=>s.cantidad),backgroundColor:sd.map((_,i)=>palette.mixed[i%palette.mixed.length]+'dd'),borderColor:'#161e2e',borderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,cutout:'55%',plugins:{legend:{position:'bottom',labels:{padding:14,usePointStyle:true,font:{size:11}}}}}})}
  const mxS=sd.length?Math.max(...sd.map(s=>s.cantidad)):1;
  sd.forEach((s,i)=>{const p=(s.cantidad/mxS*100).toFixed(0);$('#rank-servicios').innerHTML+=`<li class="rank-item"><span class="rank-pos ${rankClass(i)}">${i+1}</span><span class="rank-name">${s.estado}</span><span class="rank-bar-wrap"><span class="rank-bar" style="width:${p}%;background:${palette.amber[Math.min(i,4)]}"></span></span><span class="rank-val" style="color:${palette.amber[0]}">${s.cantidad}</span></li>`});

  // NOVEDADES
  const nd=D.novedades.por_tipo;
  if(nd.length){new Chart($('#chart-nov'),{type:'bar',data:{labels:nd.map(n=>n.tipo),datasets:[{label:'Horas',data:nd.map(n=>n.horas),backgroundColor:palette.orange[0]+'bb',borderColor:palette.orange[0],borderWidth:1,borderRadius:6,yAxisID:'y'},{label:'Cantidad',data:nd.map(n=>n.cantidad),backgroundColor:palette.blue[0]+'88',borderColor:palette.blue[0],borderWidth:1,borderRadius:6,yAxisID:'y1'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{usePointStyle:true,font:{size:11}}}},scales:{y:{beginAtZero:true,position:'left',grid:{color:'#1a2234'},title:{display:true,text:'Horas',font:{size:11}}},y1:{beginAtZero:true,position:'right',grid:{drawOnChartArea:false},title:{display:true,text:'Cantidad',font:{size:11}}},x:{grid:{display:false},ticks:{maxRotation:45,font:{size:10}}}}}})}

  // TABLE: Novedades con filtro
  const allNov=D.novedades.detalle||[];
  const tipos=new Set(allNov.map(n=>n.tipo));
  const selN=$('#filtro-nov-tipo');
  tipos.forEach(t=>{const o=document.createElement('option');o.value=t;o.textContent=t;selN.appendChild(o)});
  function rNov(f){const tn=$('#tbl-novedades tbody');tn.innerHTML='';const l=f?allNov.filter(n=>n.tipo===f):allNov;l.forEach(n=>{tn.innerHTML+=`<tr><td>${n.fecha}</td><td>${n.tecnico}</td><td><span class="badge orange">${n.tipo}</span></td><td style="font-weight:600">${n.horas}h</td></tr>`});if(!l.length)tn.innerHTML='<tr><td colspan="4" style="text-align:center;color:var(--txt3)">Sin novedades</td></tr>'}
  rNov('');selN.addEventListener('change',()=>rNov(selN.value));

  // SUPLEMENTOS charts
  const st=D.suplementos.por_tipo_error||[];
  if(st.length){new Chart($('#chart-sup-tipo'),{type:'doughnut',data:{labels:st.map(s=>s.tipo),datasets:[{data:st.map(s=>s.cantidad),backgroundColor:st.map((_,i)=>palette.mixed[i%palette.mixed.length]+'dd'),borderColor:'#161e2e',borderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,cutout:'50%',plugins:{legend:{position:'bottom',labels:{padding:10,usePointStyle:true,font:{size:10}}}}}})}
  const sf=D.suplementos.por_fuente||[];
  if(sf.length){new Chart($('#chart-sup-fuente'),{type:'doughnut',data:{labels:sf.map(s=>s.fuente),datasets:[{data:sf.map(s=>s.cantidad),backgroundColor:[palette.blue[0]+'dd',palette.red[0]+'dd',palette.purple[0]+'dd',palette.amber[0]+'dd'],borderColor:'#161e2e',borderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,cutout:'50%',plugins:{legend:{position:'bottom',labels:{padding:10,usePointStyle:true,font:{size:10}}}}}})}

  // TOP Clientes
  const tc=D.suplementos.top_clientes||[];const mxC=tc.length?tc[0].cantidad:1;const rc=$('#rank-clientes-sup');
  tc.forEach((c,i)=>{const p=(c.cantidad/mxC*100).toFixed(0);rc.innerHTML+=`<li class="rank-item"><span class="rank-pos ${rankClass(i)}">${i+1}</span><span class="rank-name">${c.cliente}</span><span class="rank-bar-wrap"><span class="rank-bar" style="width:${p}%;background:${palette.purple[Math.min(i,4)]}"></span></span><span class="rank-val" style="color:${palette.purple[0]}">${c.cantidad}</span></li>`});
  if(!tc.length)rc.innerHTML='<li style="color:var(--txt3);padding:20px;text-align:center">Sin datos</li>';

  // TABLE: Suplementos
  const ts=$('#tbl-suplementos tbody');const supD=D.suplementos.detalle||[];
  supD.forEach(s=>{ts.innerHTML+=`<tr><td>${s.fecha}</td><td>${s.cliente}</td><td>${s.numeros}</td><td class="num">${s.cantidad||1}</td><td>${s.tecnico}</td><td><span class="badge ${badgeFor(s.tipo_error)}">${s.tipo_error||'-'}</span></td><td><span class="badge ${badgeFor(s.fuente)}">${s.fuente||'-'}</span></td><td><span class="badge ${badgeFor(s.estado)}">${s.estado||'-'}</span></td></tr>`});
  if(!supD.length)ts.innerHTML='<tr><td colspan="8" style="text-align:center;color:var(--txt3)">Sin suplementos registrados</td></tr>';
}


const ENC = {"salt": "W+I7VX8oCpcwH7Usc7lvzA==", "iv": "TlFh0t1ybR39uiGi", "ciphertext": "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"};
async function decryptData(password){
  const salt=Uint8Array.from(atob(ENC.salt),c=>c.charCodeAt(0));
  const iv=Uint8Array.from(atob(ENC.iv),c=>c.charCodeAt(0));
  const ct=Uint8Array.from(atob(ENC.ciphertext),c=>c.charCodeAt(0));
  const enc=new TextEncoder();
  const km=await crypto.subtle.importKey("raw",enc.encode(password),"PBKDF2",false,["deriveKey"]);
  const key=await crypto.subtle.deriveKey({name:"PBKDF2",salt:salt,iterations:100000,hash:"SHA-256"},km,{name:"AES-GCM",length:256},false,["decrypt"]);
  const dec=await crypto.subtle.decrypt({name:"AES-GCM",iv:iv},key,ct);
  return JSON.parse(new TextDecoder().decode(dec));
}
const eyeBtn=document.getElementById('eyeBtn'),pwdInput=document.getElementById('pwdInput'),loginBtn=document.getElementById('loginBtn'),errEl=document.getElementById('loginError');
eyeBtn.addEventListener('click',()=>{if(pwdInput.type==='password'){pwdInput.type='text';eyeBtn.textContent='üîí'}else{pwdInput.type='password';eyeBtn.textContent='üëÅ'}});
pwdInput.addEventListener('keydown',e=>{if(e.key==='Enter')auth()});
loginBtn.addEventListener('click',auth);
async function auth(){
  const pwd=pwdInput.value;if(!pwd){errEl.textContent='Ingrese la contrase√±a';return}
  loginBtn.disabled=true;loginBtn.textContent='Descifrando...';errEl.textContent='';
  try{const D=await decryptData(pwd);document.getElementById('loginOverlay').classList.add('hidden');
    const r=document.getElementById('report');r.style.display='block';setTimeout(()=>r.classList.add('visible'),50);
    renderReport(D);
  }catch(e){errEl.textContent='‚ùå Contrase√±a incorrecta';loginBtn.disabled=false;loginBtn.textContent='Acceder al informe';pwdInput.select()}
}
</script></body></html>